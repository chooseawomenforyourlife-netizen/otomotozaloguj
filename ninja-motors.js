(function(Y,ie){typeof exports=="object"&&typeof module<"u"?module.exports=ie():typeof define=="function"&&define.amd?define(ie):(Y=typeof globalThis<"u"?globalThis:Y||self,Y.ninja=ie())})(this,(function(){"use strict";const Y={surveys:{accept:"Sure",decline:"Not now",finish:"Finish",next:"Next",checkBoxGroupHint:"Select one or more options",multiLineInputHint:"Add a comment",radioGroupHint:"Select one option",singleInputHint:"Add a comment"}};function ie(t={}){const e={...Y.surveys,...t.surveys};return{...Y,...t,surveys:e}}const E=ie(window.configTracking);let ke="";const Et=E?.environment??"production";if(Et==="production"){if(E?.siteUrl){const t=E.siteUrl.match(/^[\w\d-]+\.(.*)/);t?ke=t[1]:ke=E.siteUrl}}else ke=window.location.hostname||"";window.dataLayer=window.dataLayer||[];function U(t,e){return E&&t in E?E[t]:e}const $n={environment:Et,cookieDomain:ke,specialNames:["trackPage","trackEvent","trackLinkEvent","trackPerformanceEvent","cleanup"],siteUrl:U("siteUrl",""),debug:U("debug",new URLSearchParams(window.location.search).get("ninjadebug")=="1"),platform:U("platform","d"),isNative:E?.platform==="a"||E?.platform==="i",dataLayer:window[U("dataLayer","dataLayer")],disablePropertyPropagation:U("disablePropertyPropagation",!1),disableDefaultTrackPage:U("disableDefaultTrackPage",!1),getEprivacySDK:U("getEprivacySDK",void 0),asyncSurveyStyles:U("asyncSurveyStyles",!1),surveyTheme:U("surveyTheme",void 0)};function l(){return $n}const Qe="https://ninja.data.olxcdn.com",kt="https://laquesis.data.olxcdn.com",Be="https://tracking.olx-st.com/h/v2",zn="eu-ninja-debug",Mn=`${Qe}/laquesisSurvey.js`,Gn="laquesis-survey",Se={Mobile:"mobile-html5",Desktop:"desktop"},Vn="$T$",N={braze:"BRAZE",facebook:"F",ga:"GA",gtm:"G",hydra:"H",laquesis:"LQ",surveys:"LQS",comperia:"CP",adjust:"ADJUST",nr:"NEWRELIC"},jn=1800*1e3,He={ACTIVE:0,INACTIVE_VISIBLE:1,HIDDEN:2},Qn=l().debug?0:2,Bn="[Ninja]";function d(t,e=Qn){const n="color: magenta",r="font-weight: bold",i=(a,c)=>[`%c${Bn} %c${a} %c${t}:`,n,c,r];return{debug(...a){0>=e&&console.debug.apply(console,[...i("DEBUG","color: cyan"),...a])},info(...a){1>=e&&console.info.apply(console,[...i("DEBUG","color: lightblue"),...a])},warn(...a){2>=e&&console.warn.apply(console,[...i("DEBUG","color: orange"),...a])},error(...a){3>=e&&console.error.apply(console,[...i("DEBUG","color: red"),...a])}}}const se=d("EventBus");class Hn{_eventHandlers={};isValidType(e){return typeof e=="string"}isValidHandler(e){return typeof e=="function"}on(e,n){if(!e||!n||!this.isValidType(e)||!this.isValidHandler(n))return!1;let r=this._eventHandlers[e];return r||(r=this._eventHandlers[e]=[]),r.indexOf(n)>=0?!1:(r.push(n),se.debug("New listener added:",e,n),!0)}once(e,n){const r=i=>{n&&n(i),this.off(e,r)};return this.on(e,r)}off(e,n){if(!e)return this.offAll();if(!n){this._eventHandlers[e]=[];return}if(!this.isValidType(e)||!this.isValidHandler(n))return;const r=this._eventHandlers[e];if(!(!r||!r.length)){for(let i=0;i<r.length;i++)if(r[i]===n){r.splice(i,1),se.debug("Listener removed:",e,n);break}}}offAll(){this._eventHandlers={},se.debug("All listeners removed")}emit(e,n,r,i){if(!e||!this.isValidType(e))return;const s=this._eventHandlers[e];if(!s||!s.length)return;const a=this.createEvent(e,n,r,i);se.debug(`Event emit: ${e} = ${n}`,r);for(const c of s)this.isValidHandler(c)&&c(a);return a}has(e,n){if(!e||!this.isValidType(e))return!1;const r=this._eventHandlers[e];return!r||!r.length?!1:!n||!this.isValidHandler(n)?!0:r.indexOf(n)>=0}getHandlers(e){return!e||!this.isValidType(e)?[]:this._eventHandlers[e]||[]}createEvent(e,n,r,i){const s={actionType:e,value:n,props:r,meta:i,t:Date.now()};return se.debug("Event created",e,n,r,i,s),s}}const f=new Hn,D={BRAZE_INIT:"ninja/brazeInit",LAQUESIS_READY:"laquesis/ready",LAQUESIS_ASSIGNEMENTS_READY:"laquesis/assignmentsReady",LAQUESIS_FLAG_ASSIGNMENT:"laquesis/flagAssignment",LAQUESIS_EXP_ASSIGNMENT:"laquesis/experimentAssignment",LAQUESIS_EXP_IMPRESSION:"laquesis/experimentImpression",LAQUESIS_SURVEY_SHOW:"laquesis/surveyShow",LAQUESIS_SURVEY_CLOSE:"laquesis/surveyClose"},k={TRACK_FETCH_MATRIX:"trackFetchMatrix",TRACK_FEATURE_USAGE:"trackFeatureUsage",TRACK_WEB_VITAL:"trackWebVital",TRACK_SURVEY:"trackSurvey"},be={TEST_ASSIGNMENT:"test_assignment",TEST_IMPRESSION:"test_impression",FLAG_ASSIGNMENT:"flag_assignment"},p={DEFINITION_RELOAD:"laquesis-internal/definitionReload",TRACK_EXP_ASSIGNMENT:"laquesis-internal/trackExpAssignment",TRACK_FLAG_ASSIGNMENT:"laquesis-internal/trackFlagAssignment",TRACK_IMPRESSION:"laquesis-internal/trackImpression",ASSIGN_QA_SURVEY:"laquesis-internal/assignQaSurvey",ASSIGN_SURVEYS:"laquesis-internal/assignSurveys",INIT_SURVEYS_STORAGE:"laquesis-internal/initSurveysStorage",SETUP_SURVEYS_WINDOW:"laquesis-internal/setupSurveysWindow",CHECK_SURVEYS_FOR_TRIGGER:"laquesis-internal/checkSurveysForTrigger",TRIGGER_SURVEY:"laquesis-internal/triggerSurvey",TRACK_SURVEY_TRIGGER:"laquesis-internal/trackSurveyTrigger",CLOSE_SURVEY:"laquesis-internal/closeSurvey"},Kn={FETCHING_MATRIX:"fetching_matrix"};var Ke=function(t,e){return Ke=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i])},Ke(t,e)};function Yn(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}Ke(t,e),t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function St(t,e,n){if(n||arguments.length===2)for(var r,i=0,s=e.length;i<s;i++)!r&&i in e||(r||(r=Array.prototype.slice.call(e,0,i)),r[i]=e[i]);return t.concat(r||Array.prototype.slice.call(e))}typeof SuppressedError=="function"&&SuppressedError,(function(t){function e(n,r){var i=t.call(this,"Pattern matching for ".concat(n," failed, review the reservoir for conflicting cookie names and patterns."))||this;return i.name="PatternMatchingError",i.cookieName=n,i.matchingPatterns=r,i}return Yn(e,t),e})(Error);var Wn=function(t){var e;if(!t)return null;var n=(e=t.split("&").find((function(i){return i.startsWith("groups=")})))===null||e===void 0?void 0:e.split("=")[1];if(!n)return null;var r=n.split(",").reduce((function(i,s){var a=s.split(":"),c=a[0],u=a[1];return c&&u==="1"?St(St([],i,!0),[c],!1):i}),[]);return r};function Jn(t,e,n){if(t[e])return t[e];var r=Object.keys(t).reduce((function(i,s){var a,c=(a=s,a.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).replace(/\\\$\\\{(\d+?)\\\}/g,"[A-Za-z0-9]{$1}");return new RegExp("^"+c+"$").test(e)&&i.push(s),i}),[]);return r.length>0&&r[0]?t[r[0]]:null}var V;(function(t){t.C0001="C0001",t.C0002="C0002",t.C0003="C0003",t.C0004="C0004"})(V||(V={}));function Ie(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}var Te=(function t(e,n){function r(i,s,a){if(typeof document<"u"){typeof(a=Ie({},n,a)).expires=="number"&&(a.expires=new Date(Date.now()+864e5*a.expires)),a.expires&&(a.expires=a.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var c="";for(var u in a)a[u]&&(c+="; "+u,a[u]!==!0&&(c+="="+a[u].split(";")[0]));return document.cookie=i+"="+e.write(s,i)+c}}return Object.create({set:r,get:function(i){if(typeof document<"u"&&(!arguments.length||i)){for(var s=document.cookie?document.cookie.split("; "):[],a={},c=0;c<s.length;c++){var u=s[c].split("="),h=u.slice(1).join("=");try{var v=decodeURIComponent(u[0]);if(a[v]=e.read(h,v),i===v)break}catch{}}return i?a[i]:a}},remove:function(i,s){r(i,"",Ie({},s,{expires:-1}))},withAttributes:function(i){return t(this.converter,Ie({},this.attributes,i))},withConverter:function(i){return t(Ie({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(n)},converter:{value:Object.freeze(e)}})})({read:function(t){return t[0]==='"'&&(t=t.slice(1,-1)),t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(t){return encodeURIComponent(t).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}},{path:"/"}),Xn=[];typeof window<"u"&&{OnConsentChanged:function(t){var e=window.OptanonWrapper;window.OptanonWrapper=function(){var n;e?.(),(n=window.OneTrust)===null||n===void 0||n.OnConsentChanged(t)}}}.OnConsentChanged((function(){Xn.forEach((function(t){t(Ye())}))}));function Ye(){var t=(function(){var e,n=window.OnetrustActiveGroups;if(n&&!/^,+$/g.test(n))return n;var r=(e=Wn(Te.get("OptanonConsent")))===null||e===void 0?void 0:e.join(",");return r??V.C0001})();return t?t.split(",").filter((function(e){return Object.values(V).some((function(n){return n===e}))})):[]}function bt(t){return Ye().includes(t)}var Zn=function(t){return"The cookie you are trying interact with (".concat(t,") is not categorised according to company's policy. Due to legal requirements each cookie stored in user's browser must be documented and classified in the data reservoir. For instructions on how to fix this visit the documentation of OLX Group's ePrivacy storage: https://git.naspersclassifieds.com/olxeu/ecosystem/eprivacy-storage.")},It=function(t,e,n,r){var i=Jn(t,e);if(!i)return n&&console.error(Zn(e)),!1;var s=i.every((function(a){return bt(a)}));return s};function Tt(t,e,n,r){return{set:function(i,s,a){if(!t||e&&It(e,i,n))return Te.set(i,s,a)},get:function(i){if(!t||e&&It(e,i,n))return Te.get(i)},remove:function(i,s){Te.remove(i,s)}}}var ae,j,oe;(function(t){t.OLX="OLX",t.RE="RE",t.Motors="Motors",t.Fixly="Fixly"})(j||(j={})),(function(t){t.STG="STG",t.PRD="PRD"})(oe||(oe={}));var er=((ae={})[j.OLX]="olx",ae[j.RE]="real-estate",ae[j.Motors]="motors",ae[j.Fixly]="fixly",ae);function tr(t,e){return"https://eprivacy-storage.".concat(e===oe.STG?"staging-":"","eu-sharedservices.olxcdn.com/data/").concat(er[t],"/cookies.json")}async function nr(t,e){const n=await fetch(t,e);if(!n.ok)throw new Error(n.statusText);return n}async function ce(t){return await(await nr(t)).json()}let We;async function rr(){{const t=`${Qe}/config-${JSON.parse('"motors"'.toLowerCase())}-web.json`;We=await ce(t)}return We}function _(){return We}let Je;const ir=d("configs/hydra");function m(){try{if(!Je){const t=_(),e=t.config[N.hydra],n=t.custom?.[l().siteUrl]?.config[N.hydra];Je=n?{...e,...n}:e}}catch(t){ir.debug("Error getting hydra config",t)}return Je}const sr=[V.C0002,V.C0003];function ar(t){return l().isNative?!1:t==="hydra"||!Ct()?!0:sr.every(bt)}function Ct(){return l().isNative?!1:!!m().eprivacy_scope}function _t(t="dataLayer"){const e=window[t];if(!Array.isArray(e))return;const n=function(...s){e.unshift(s)},r="granted";n("consent","default",{ad_storage:r,ad_user_data:r,ad_personalization:r,analytics_storage:r})}const Xe="1.6.x",ue=d("CookieStorage");function Ce(){return{set:()=>{ue.info("empty storage")},get:()=>{ue.info("empty storage")},remove:()=>{ue.info("empty storage")}}}let g=Ce(),le=!1;const At={sameSite:"Lax",secure:location.protocol==="https:",path:"/",domain:l().cookieDomain};async function or(){if(le)return g;if(Ct()){const t=l();if(typeof t.getEprivacySDK=="function")return g=_e(t.getEprivacySDK()),le=!0,g;if(window.eprivacyStorage?.[Xe])return g=_e(window.eprivacyStorage[Xe]),le=!0,g;{const e=await cr();if(g=_e(e),g)return window.eprivacyStorage||(window.eprivacyStorage={}),window.eprivacyStorage[Xe]=e,le=!0,g}}else return g=_e(Tt(!1)),le=!0,g;return Ce()}async function cr(){const t=m();if(t.eprivacy_scope){const e=tr(j[t.eprivacy_scope],l().environment=="production"?oe.PRD:oe.STG);try{const n=await ce(e);return Tt(!0,n,!1)}catch(n){return ue.error("Ninja can not load cookie category definitions!",e,n),Ce()}}return ue.error("Ninja can not load cookie category definitions - missing `eprivacy_scope` for current region!"),Ce()}function _e(t){const e={get(n,r,i){const s=n[r];return s instanceof Function?function(...a){const c=[...a];return r==="set"&&(c.length===2?c.push(At):c[2]={...At,...c[2]}),s.apply(this===i?n:this,c)}:s}};return new window.Proxy(t,e)}const ur={s:1e3,min:60*1e3,h:3600*1e3,day:1440*60*1e3,month:744*60*60*1e3,year:365*24*60*60*1e3};function x(t,e="s"){const n=new Date,r=ur[e]||-1;return n.setTime(n.getTime()+t*r),n}function Ze(t,e=[],n=[]){const r=window.location.hostname.split("."),i=[encodeURIComponent(t)+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; path=/"];let s;for(;r.length>1;){const a=r.join(".");let c=[];Array.isArray(e)&&!e.includes(a)&&(c=[a]),a.match(/^www\./)||(c.push("www."+a),c.push(".www."+a));for(const u of c){s=encodeURIComponent(t)+"=; expires=Thu, 01-Jan-1970 00:00:01 GMT; domain="+u+" ;path=",i.includes(s+"/")||i.push(s+"/");const h=location.pathname.split("/");for(;h.length>0;){const v=h.join("/");v!=="/"&&v!==""&&!n.includes(v)&&i.push(s+v),h.pop()}}r.shift()}for(const a of i)document.cookie=a;return i}const Pt={};function q(t){const e=l();let n=t,r=Pt[n];return r||(r=new RegExp("\\b"+n+"\\b","gi"),Pt[n]=r),e.environment==="production"&&(document.cookie.match(r)||[]).length>1&&Ze(n,[e.cookieDomain]),n==="onap"&&e.environment!=="production"&&(n+="_dev"),n}const Lt=d("cookies/ninja/onap"),Rt=q("onap"),lr=q("lqonap");function dr(t=""){const e=t.slice(0,14);let n=Date.now();return e.length===13?n=parseInt(e):e.length==10&&(n=parseInt(e)*1e3),n}function gr(){return g.get(lr)}function fr(){let t;const n=g.get(Rt)?.match(/([a-z0-9]+)-([0-9]+)-([a-z0-9]+)-([0-9]+)-([0-9]+)-?(.*)?/);return n&&(Lt.debug("Reading ONAP cookie",n),t={sessionLong:n[1],sessionCountLong:parseInt(n[2],10),session:n[3],sessionCount:parseInt(n[4],10),expires:dr(n[5]),extra:n[6]}),t}function Ut(t){const e=[t.sessionLong,t.sessionCountLong,t.session,t.sessionCount,t.expires];t.extra&&e.push(t.extra),g.set(Rt,e.join("-"),{expires:x(1,"year")}),Lt.debug("Writing ONAP cookie",e)}const o={activeExps:new Map,activeFlags:new Set,activeSurveys:[],cookieFromLq:!1,currentPlatform:"",currentSession:void 0,firstTrackedPageEvent:"",isLQRefreshNeeded:!1,isSurveyTriggered:!1,playgroundMode:!1,surveyTriggerMap:{},userId:void 0,userUUId:void 0,impressionsQueue:new Map},Ae=d("sessionManager");function pr(){Ae.debug("Starting session");let t=fr();if(!t){const e=gr();e?(t=Dt(e),o.cookieFromLq=!0,Ae.debug("Using LQONAP cookie as session_long")):(t=Dt(),Ae.debug("Generated new session",t))}return o.currentSession=t,Ut(o.currentSession),t}function hr(t){return mr(t)?(t.session=Nt(),t.sessionCountLong+=1,t.sessionCount=1,Ae.debug("Session expired, generating new session",t)):t.sessionCount+=1,xt(t),t}function Nt(){return`${Date.now().toString(16)}x${Math.ceil(Math.random()*4294967295).toString(16)}`}function Dt(t=Nt()){const e={sessionLong:t,session:t,sessionCountLong:1,sessionCount:0,expires:0};return xt(e),e}function xt(t){t.expires=Date.now()+jn}function mr(t){return t.expires<=Date.now()}function vr(){return o.currentSession=hr(o.currentSession),Ut(o.currentSession),{sessionLong:o.currentSession.sessionLong,session:o.currentSession.session,sessionCountLong:o.currentSession.sessionCountLong,sessionCount:o.currentSession.sessionCount}}const de=d("utils/browser");function Ft(){return new URLSearchParams(window.location.search)}function Pe(t,e,n=document.body,r){return new Promise((i,s)=>{if(document.getElementById(e)){i(!0);return}if(typeof document.createElement=="function")try{const c=document.createElement("script");c.type="text/javascript",c.async=!0,r&&Object.entries(r).forEach(([u,h])=>{c.setAttribute(u,h)}),c.id=e,c.addEventListener("load",()=>{de.debug(`Script loaded: ${t} with id=${e}`),i(!0)}),c.addEventListener("error",()=>{de.error(`Script NOT loaded: ${t} with id=${e}`),s(`Failed to load script: ${e}`)}),de.debug(`Loading script: ${t} with id=${e}`),c.src=t,n.appendChild(c)}catch(c){s(c)}})}function et(){let t=window.location.pathname;return t.charAt(0)==="/"&&t.length>1&&(t=t.slice(1)),t.charAt(t.length-1)==="/"&&t.length>1&&(t=t.slice(0,t.length-1)),t.search(/\./)>0&&(t=t.replace(/(\.[a-z]+$)/,"")),(t==="/"||t==="")&&(t="home"),t}function yr(){try{const t=window.localStorage,e="__storage_test__";return t.setItem(e,e),t.removeItem(e),!0}catch{return!1}}async function wr(t,e,n=document.head){return new Promise((r,i)=>{if(document.getElementById(e))r(!0);else{const s=document.createElement("link");s.rel="stylesheet",s.href=t,s.id=e,s.addEventListener("load",()=>{de.debug(`css loaded: ${t} with id=${e}`),r(!0)}),s.addEventListener("error",()=>{de.error(`css NOT loaded: ${t} with id=${e}`),i(`Failed to load css: ${e}`)}),n.appendChild(s)}})}const Er={\u00E1:"a",\u00C1:"A",\u00E9:"e",\u00C9:"E",\u00ED:"i",\u00CD:"I",\u00F3:"o",\u00D3:"O",\u00FA:"u",\u00DA:"U",\u00F1:"n",\u00D1:"N"};function Le(t){return t.replace(/[^A-Za-z0-9\-_]/g,e=>Er[e]||e)}const tt="NINJA_SEPARATOR",Re=new RegExp(tt,"g"),qt="invite",Ot="utm_source",kr=["utm_medium","utm_campaign","utm_term","utm_content","utm_id"],$t="itm_source",Sr=["itm_medium","itm_campaign","itm_term","itm_content","itm_id"];function br(){if(!window.location.search)return"";const t=Ft();let e=[],n="";if(t.has(qt)?(n=t.get(qt),e=Tr(n)):t.has(Ot)&&(e=zt(t,kr),n=t.get(Ot)),n){const r=Le(decodeURIComponent(n)).replace(/\s/g,"").replace(Re,"-"),i=Le(decodeURIComponent(e.join("--"))).replace(/\s/g,"").replace(Re,"-");return`${r}_${i}`}return""}function Ir(){const t=Ft();if(!t.has($t))return"";const e=t.get($t),n=zt(t,Sr);if(n.length>0){const r=Le(decodeURIComponent(e)).replace(/\s/g,"").replace(Re,"-"),i=Le(decodeURIComponent(n.join("--"))).replace(/\s/g,"").replace(Re,"-");return`${r}_${i}`}return""}function Tr(t){const e=t.match(/^\s*([a-zA-Z0-9-]{1,64})(?:_([a-zA-Z0-9%-]{0,128})).*/);return e&&e.length>0?[e[1],e[2]]:[]}function zt(t,e){return e.reduce((n,r)=>t.has(r)?[...n,Cr(t.get(r),tt)]:n,[])}function Cr(t,e=tt){return t.replace(/[-_.]/g,e)}function ge(t,...e){const n={...t};for(const r of e)delete n[r];return n}function fe(t){return Object.entries(t).map(([e,n])=>`${encodeURIComponent(e)}=${encodeURIComponent(n)}`).join("&")}function _r(t){return Object.prototype.toString.call(t)==="[object Object]"}function F(t,e,n=document){const r=new CustomEvent(t,{detail:e});n.dispatchEvent(r)}function Mt(t){return _r(t)?l().specialNames?.find(e=>e in t)!==void 0:!1}function Gt(){return{invite:br(),itm:Ir(),host:window.location.host,hash:window.location.hash,referrer:document.referrer,sessionParams:vr()}}function nt(t){return t.meta?t:{...t,meta:Gt()}}function Ar(t){return Object.values(be).includes(t)}function Pr(t,e,n=!1){const r=n?[]:e,i={};for(const s of r)if(!(s.processed!==!0||!Mt(s)))for(const[a,c]of Object.entries(s))l().specialNames.includes(a)||(i[a]=c);return{...i,...t}}function Vt(t){const e=m(),n=_(),r={};return e?.params?.cC&&(r.cC=e.params.cC),e?.params?.bR&&(r.bR=e.params.bR),n?.version&&(r.mv=n.version),r.ninjaVer='"517f2a47"',l().environment!=="production"&&(r.env="dev"),t.actionType=="trackEvent"?r.tN="e":t.actionType=="trackPage"&&(r.tN="p"),r}function S(t,e,n,r=!1){const i=N[t],s=Lr(i,e);let a=Rr(i,e,n);if(a===void 0&&r&&(a=n),s!==void 0&&a!==void 0)return{key:s,value:a}}function Ue(t,e={}){return Object.entries(e).reduce((n,[r,i])=>{const s=S(t,r,i);return s?.key!==void 0&&s?.value!==void 0&&(n[s.key]=s.value),n},{})}function Lr(t,e){return _()?.map?.[e]?.N?.[t]}function Rr(t,e,n){return["trackPage","trackEvent"].includes(e)?Ur(t,e,n):Nr(t,e,n)}function Ur(t,e,n){return _()?.map?.[e]?.V?.[n]?.[t]}function Nr(t,e,n){const r=_();return r?.map?.[e]?r?.map?.[e]?.V?.[n]?.[t]??n:void 0}function Dr(t,e,n={}){const r=Ue(t,e.props),i=Ue(t,Vt(e));return{...r,...n,...i}}const Ne=window,xr=(t,e={})=>{const n=ge(e,"trackPage");return Ne?.NinjaAndroid?.trackView(t,JSON.stringify(n))},jt=(t,e={})=>{const n=ge(e,"trackEvent");return Ne?.NinjaAndroid?.trackEvent(t,JSON.stringify(n))},Fr=Object.freeze(Object.defineProperty({__proto__:null,flushDelayed:()=>{},getLaquesisVariant:t=>Ne?.LaquesisAndroid?.getVariant(t),isFeatureEnabled:t=>Ne?.LaquesisAndroid?.isFlagEnabled(t)??!1,trackEvent:jt,trackEventDelayed:jt,trackPage:xr},Symbol.toStringTag,{value:"Module"})),Q="#",Qt="@",rt="|",qr="!",B={LAQUESIS:q("laquesis"),LAQUESIS_FF:q("laquesisff")},Bt=120,it="laquesissu",Or="_lq_surveys_",$r="_lq_surveys_type_",st=d("cookies/lqstatus"),Ht=q("lqstatus");function zr(){const t=g.get(Ht);return st.debug("Reading cookie",t),t}function W(t){const e=[t.nextRefresh,t.currentSession||"",t.trackedExperiments,t.nextSurveyShow||"",t.showedSurveys?t.showedSurveys.join(Q):"",t.isDefinitionsForUserId?"1":"0",t.lastRefresh,t.isDefinitionsForUUId?"1":"0"];st.debug("Writing cookie",e),g.set(Ht,e.join(rt),{expires:x(1,"year"),path:"/",domain:l().cookieDomain})}function O(){const t=zr();return t?Mr(t):{nextRefresh:-1,currentSession:"",trackedExperiments:"",nextSurveyShow:0,showedSurveys:[],isDefinitionsForUserId:!1,lastRefresh:0,isDefinitionsForUUId:!1}}function Mr(t=""){const e=t.split(rt),n={nextRefresh:e[0],currentSession:e[1]||"",trackedExperiments:e[2],nextSurveyShow:e[3],showedSurveys:e[4],isDefinitionsForUserId:e[5]==="1",lastRefresh:e[6]||0,isDefinitionsForUUId:e[7]==="1"};return/\d{10}/.test(n.nextRefresh)?n.nextRefresh=parseInt(n.nextRefresh,10):n.nextRefresh=0,/^([a-z]{1}[a-z\d]{0,9}-\d+#?)+$/.test(n.trackedExperiments)||(n.trackedExperiments=""),/\d{10}/.test(n.nextSurveyShow)?n.nextSurveyShow=parseInt(n.nextSurveyShow,10):n.nextSurveyShow=0,/^(\d+#?)*[^#]$/.test(n.showedSurveys)?n.showedSurveys=n.showedSurveys.split(Q):n.showedSurveys=[],/\d{10}/.test(n.lastRefresh)?n.lastRefresh=parseInt(n.lastRefresh,10):n.lastRefresh=0,st.debug("Parsing cookie",n),n}function at(t="",e=()=>{}){const n=t?.replace(/^"(.+)"$/,"$1")??"",r=new Map;if(n)for(const i of n.split(Q)){if(!i)continue;const s=i.split(Qt);if(s.length===2){const a=s[1].split(rt);a.length===2?a[1]==="t"&&(typeof e=="function"&&e(s[0],a[0]),r.has(s[0])||r.set(s[0],a[0])):r.has(s[0])||r.set(s[0],a[0])}}return r}function Kt(t=""){const e=new Set;if(t)for(const n of t.split(Q))n&&!(n in e)&&e.add(n);return e}const $=window,Gr=(t,e={})=>{const n=ge(e,"trackPage");return $?.webkit?.messageHandlers?.trackView.postMessage({name:t,params:n})},Yt=(t,e={})=>{const n=ge(e,"trackEvent");return $?.webkit?.messageHandlers?.trackEvent.postMessage({name:t,params:n})},Vr=Object.freeze(Object.defineProperty({__proto__:null,flushDelayed:()=>{},getLaquesisVariant:t=>{const e=t.toLowerCase();if($?.webkit?.messageHandlers?.getVariant.postMessage(e),$.LaquesisIOS?.experiments)return at($.LaquesisIOS.experiments).get(e)},isFeatureEnabled:t=>{const e=t.toLowerCase();return $?.webkit?.messageHandlers?.isFlagEnabled.postMessage(e),$.LaquesisIOS?.flags?Kt($.LaquesisIOS.flags).has(e):!1},trackEvent:Yt,trackEventDelayed:Yt,trackPage:Gr},Symbol.toStringTag,{value:"Module"})),jr=d("native/handler");function Qr(t){let e;if(l().platform==="a"?e=Fr[t]:l().platform==="i"&&(e=Vr[t]),typeof e!="function"){jr.warn(`Function ${t} not defined in native bridge!`);return}return e}function ot(t,...e){const n=Qr(t);if(n)return n(...e)}const A=d("dataLayer");class Br{isInitialized=!1;items=[];constructor(){this.items=l().dataLayer}init(){if(!this.isInitialized){const e=this.items.push;this.items.push=(...n)=>{A.debug("dataLayer.push",...n);for(const r of n){const i=this.processItem(r);i&&e.apply(this.items,[i])}return this.items.length},A.debug("dataLayer initialized"),this.isInitialized=!0}}processItem(e){A.debug("Processing item",e);const n=l(),r=n.specialNames?.find(i=>i in e);if(r){if(!e.processed){const i=Array.isArray(e[r])?e[r].join("_"):e[r],s=ge(e,...n.specialNames);if(A.debug("processing Ninja event:",r,i,s),n.isNative){const v=ot(r,i,s);return A.debug("nativeHandlerFn result:",v),null}if(r==="cleanup"){A.debug("cleanup"),this.cleanup(),typeof e.cleanup=="function"&&(A.debug("cleanup function called"),e.cleanup());return}const a=Ar(i),c=Pr(s,this.items,l().disablePropertyPropagation||a),u=Gt(),h=f.emit(r,i,c,u);return a?null:{...e,[Vn]:h?.t??Date.now(),processed:!0}}return A.debug("Ninja event already processed:",r,e),e}return e}async processDataLayer(){if(this.items.length){A.debug("processing existing items in dataLayer",this.items);for(let e=0;e<this.items.length;e++){const n=this.items[e],r=this.processItem(n);r&&(this.items[e]=r)}}}push(e){return this.items.push(e)}cleanup(){let e=!0;try{for(;e;){e=!1;for(let n=0;n<this.items.length;n++)Mt(this.items[n])&&(e=this.items[n].cleanup===void 0,this.items.splice(n,1),n=length)}}catch(n){A.info(n)}}}const P=new Br;function Hr(){return{get session(){return{...o.currentSession??{}}},get playgroundMode(){return o.playgroundMode},get userId(){return o.userId},get userUUId(){return o.userUUId},get activeExperiments(){return[...o.activeExps.entries()].reduce((t,[e,n])=>({...t,[e]:n}),{})},get activeFlags(){return[...o.activeFlags]},get activeSurveys(){return o.activeSurveys.map(t=>t.id)}}}const pe={HIGHEST:1,HIGH:10,LOW:1e3};class ct{size=0;array=[];runningCounter=0;compare;constructor(e){this.compare=e||ct.defaultComparator}static defaultComparator=(e,n)=>e<n?-1:e>n?1:0;stableCompare(e,n){const r=this.compare(e.value,n.value);return r<0||r===0&&e.counter<n.counter}renumber(){const e=[];for(;!this.isEmpty();)e.push(this.pop());const n=e.length;this.runningCounter=0;for(let r=0;r<n;r++)this.push(e[r])}push(e){const n=this.size;this.runningCounter+1===0&&this.renumber();const r={value:e,counter:this.runningCounter};this.array[this.size]=r,this.runningCounter+=1,this.size+=1,this.bubbleUp(n,r)}bubbleUp(e,n){let r,i;for(;e>0&&(r=e-1>>1,i=this.array[r],!!this.stableCompare(n,i));)this.array[e]=i,e=r;this.array[e]=n}bubbleDown(e){const n=this.size,r=this.size>>>1,i=this.array[e];let s,a,c;for(;e<r&&(s=(e<<1)+1,a=s+1,c=this.array[s],a<n&&this.stableCompare(this.array[a],c)&&(s=a,c=this.array[a]),!!this.stableCompare(c,i));)this.array[e]=c,e=s;this.array[e]=i}peek(){if(this.size!==0)return this.array[0].value}pop(){if(this.size===0)return;const e=this.array[0];return this.size>1?(this.array[0]=this.array[--this.size],this.bubbleDown(0)):this.size-=1,e.value}trim(){this.array=this.array.slice(0,this.size)}isEmpty(){return this.size===0}}const J=d("TaskQueue");class Kr{queue;runningCount;concurrencyLimit;isPaused;maxQueueSize;eventListeners;runTimeout=null;nextTaskId;nextPriority=pe.LOW;runDebounceTimeMs=50;constructor(e=1,n=1/0){this.queue=new ct((r,i)=>r.priority-i.priority),this.runningCount=0,this.concurrencyLimit=e,this.isPaused=!1,this.maxQueueSize=n,this.eventListeners={},this.nextTaskId=1}enqueue({fn:e,priority:n=0,retries:r=0,timeout:i=null,taskId:s=this.generateTaskId()}){if(this.queue.size>=this.maxQueueSize){J.error("Queue is full. Can't add more tasks.");return}const a={fn:e,priority:n||this.nextPriority++,retries:r,maxRetries:r,timeout:i,taskId:s};this.queue.push(a),J.debug("Task enqueued",a),this.isPaused||this.run()}async run(){this.isPaused||this.runningCount>=this.concurrencyLimit||this.queue.isEmpty()||this.runTimeout||(this.runTimeout=setTimeout(async()=>{for(this.runTimeout=null;this.runningCount<this.concurrencyLimit&&!this.queue.isEmpty();){this.runningCount++;const e=this.queue.pop();if(J.debug("Running task",e,this.queue),e){this.triggerEvent("taskStart",e);try{await this.executeTask(e),this.triggerEvent("taskComplete",e)}catch{this.triggerEvent("taskError",e)}}this.runningCount--,J.debug("Task finished",e,this.queue)}await this.run()},this.runDebounceTimeMs))}async executeTask(e){let n=0;for(;n<=e.maxRetries;){n++;try{e.timeout?await this.runWithTimeout(e.fn,e.timeout):await e.fn();break}catch(r){if(n>e.maxRetries)throw r}}}runWithTimeout(e,n){return new Promise((r,i)=>{const s=setTimeout(()=>i(new Error("Task timed out")),n);e().then(a=>{clearTimeout(s),r(a)}).catch(a=>{clearTimeout(s),i(a)})})}pause(){this.isPaused=!0,J.debug("queue processing paused")}resume(){this.isPaused&&(this.isPaused=!1,J.debug("queue processing resumed"),this.run())}on(e,n){this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push(n)}triggerEvent(e,n){this.eventListeners[e]&&this.eventListeners[e].forEach(r=>r(n))}getNextTaskId(){return this.queue.peek()?.taskId??null}generateTaskId(e="task"){return`${e}-${this.nextTaskId++}`}isEmpty(){return this.queue.isEmpty()}size(){return this.queue.size}}const X=new Kr(1),Yr=d("BaseTracker");class z{isInitialized;isInitPushed;listeners;trackerName;scriptTagId;scriptUrl;isListening=!1;constructor(){this.isInitialized=!1,this.listeners={}}async setupListeners(){if(!this.isListening){for(const[e,n]of Object.entries(this.listeners))f.off(e,n),f.on(e,n);Yr.debug(`${this.trackerName} tracker callbacks set up`),this.isListening=!0}return this}cleanup(){this.isInitialized=!1}trackLinkEvent(e){return f.emit(k.TRACK_FEATURE_USAGE,"",{message:"trackers/trackLinkEvent"}),this.trackEvent(e,!0)}getToken(){return _()?.custom?.[l().siteUrl]?.config?.[N[this.trackerName]]?.code}getTrackParams(e,n={}){return Dr(this.trackerName,e,n)}initAndExecute(e){X.enqueue({fn:async()=>{await this.setupListeners(),await this.init()},priority:pe.HIGH,taskId:X.generateTaskId(`initAndExecute_${this.trackerName}`)}),X.enqueue({fn:e})}hasRequiredConsent(){return ar(this.trackerName)}}function Wr(t){window.laquesisResults=window.laquesisResults||[];const e=window.laquesisResults.push;window.laquesisResults.push=n=>{const r=e.apply(window.laquesisResults,[n]);return f.emit(k.TRACK_FEATURE_USAGE,"",{message:"laquesis/cookie watcher used: "+n.newResult}),Wt(t),r}}function Wt(t){if(window.laquesisResults){for(const e of window.laquesisResults)if(typeof e=="object"&&!e.processed&&e.newResult!==void 0){e.processed=!0;const n=at(e.newResult,t);o.activeExps=new Map([...o.activeExps,...n])}}}const Jt=d("laquesis/definition");async function Xt(){Jt.debug("reload definitions");const t=await Jr();o.isLQRefreshNeeded=!1,Object.keys(t).length&&Xr(t)}async function Jr(){const t={sl:o.currentSession?.sessionLong,br:m().params?.bR,cc:m().params?.cC,ch:l().platform};o.userId&&(t.ui=o.userId),o.userUUId&&(t.user_uuid=o.userUUId);const e=`${kt}/assign?${fe(t)}`;return Jt.debug("fetch definitions",e),ce(e)}function Xr(t){f.emit(p.ASSIGN_SURVEYS,"",{surveys:t.surveys});const e=Zr(t.tests),n=ei(t.flags),r=O(),i=Date.now();r.lastRefresh=i,r.nextRefresh=i+(t.config?.next_update_foreground_in_minutes??0)*60*1e3,W(r),g.set(B.LAQUESIS,e,{expires:x(1,"year"),path:"/",domain:l().cookieDomain}),f.emit(p.TRACK_EXP_ASSIGNMENT,""),F(D.LAQUESIS_EXP_ASSIGNMENT,{experiments:e}),g.set(B.LAQUESIS_FF,n,{expires:x(1,"year"),path:"/",domain:l().cookieDomain}),f.emit(p.TRACK_FLAG_ASSIGNMENT,""),F(D.LAQUESIS_FLAG_ASSIGNMENT,{flags:n}),typeof window.laquesisAssignCallback=="function"&&(f.emit(k.TRACK_FEATURE_USAGE,"",{message:"laquesis/laquesisAssignCallback"}),window.laquesisAssignCallback.call(null)),F(D.LAQUESIS_ASSIGNEMENTS_READY,{experiments:e,flags:n})}function Zr(t){return t.sort((n,r)=>n.tN.localeCompare(r.tN)),o.activeExps.clear(),t.map(n=>{const r=n.tN.toLowerCase(),i=n.vN.toLowerCase();return o.activeExps.set(r,i),Q+r+Qt+i}).join("").slice(1)}function ei(t){return t.sort((n,r)=>n.tN.localeCompare(r.tN)),o.activeFlags.clear(),t.map(n=>{const r=n.tN.toLowerCase();return o.activeFlags.add(r),Q+r}).join("").slice(1)}var ut,M,he,Zt,De,en=-1,H=function(t){addEventListener("pageshow",(function(e){e.persisted&&(en=e.timeStamp,t(e))}),!0)},lt=function(){var t=self.performance&&performance.getEntriesByType&&performance.getEntriesByType("navigation")[0];if(t&&t.responseStart>0&&t.responseStart<performance.now())return t},xe=function(){var t=lt();return t&&t.activationStart||0},T=function(t,e){var n=lt(),r="navigate";return en>=0?r="back-forward-cache":n&&(document.prerendering||xe()>0?r="prerender":document.wasDiscarded?r="restore":n.type&&(r=n.type.replace(/_/g,"-"))),{name:t,value:e===void 0?-1:e,rating:"good",delta:0,entries:[],id:"v4-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12),navigationType:r}},Z=function(t,e,n){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var r=new PerformanceObserver((function(i){Promise.resolve().then((function(){e(i.getEntries())}))}));return r.observe(Object.assign({type:t,buffered:!0},n||{})),r}}catch{}},C=function(t,e,n,r){var i,s;return function(a){e.value>=0&&(a||r)&&((s=e.value-(i||0))||i===void 0)&&(i=e.value,e.delta=s,e.rating=(function(c,u){return c>u[1]?"poor":c>u[0]?"needs-improvement":"good"})(e.value,n),t(e))}},dt=function(t){requestAnimationFrame((function(){return requestAnimationFrame((function(){return t()}))}))},me=function(t){document.addEventListener("visibilitychange",(function(){document.visibilityState==="hidden"&&t()}))},Fe=function(t){var e=!1;return function(){e||(t(),e=!0)}},ee=-1,tn=function(){return document.visibilityState!=="hidden"||document.prerendering?1/0:0},qe=function(t){document.visibilityState==="hidden"&&ee>-1&&(ee=t.type==="visibilitychange"?t.timeStamp:0,ti())},nn=function(){addEventListener("visibilitychange",qe,!0),addEventListener("prerenderingchange",qe,!0)},ti=function(){removeEventListener("visibilitychange",qe,!0),removeEventListener("prerenderingchange",qe,!0)},gt=function(){return ee<0&&(ee=tn(),nn(),H((function(){setTimeout((function(){ee=tn(),nn()}),0)}))),{get firstHiddenTime(){return ee}}},ve=function(t){document.prerendering?addEventListener("prerenderingchange",(function(){return t()}),!0):t()},rn=[1800,3e3],sn=function(t,e){e=e||{},ve((function(){var n,r=gt(),i=T("FCP"),s=Z("paint",(function(a){a.forEach((function(c){c.name==="first-contentful-paint"&&(s.disconnect(),c.startTime<r.firstHiddenTime&&(i.value=Math.max(c.startTime-xe(),0),i.entries.push(c),n(!0)))}))}));s&&(n=C(t,i,rn,e.reportAllChanges),H((function(a){i=T("FCP"),n=C(t,i,rn,e.reportAllChanges),dt((function(){i.value=performance.now()-a.timeStamp,n(!0)}))})))}))},an=[.1,.25],ni=function(t,e){e=e||{},sn(Fe((function(){var n,r=T("CLS",0),i=0,s=[],a=function(u){u.forEach((function(h){if(!h.hadRecentInput){var v=s[0],re=s[s.length-1];i&&h.startTime-re.startTime<1e3&&h.startTime-v.startTime<5e3?(i+=h.value,s.push(h)):(i=h.value,s=[h])}})),i>r.value&&(r.value=i,r.entries=s,n())},c=Z("layout-shift",a);c&&(n=C(t,r,an,e.reportAllChanges),me((function(){a(c.takeRecords()),n(!0)})),H((function(){i=0,r=T("CLS",0),n=C(t,r,an,e.reportAllChanges),dt((function(){return n()}))})),setTimeout(n,0))})))},on=0,ft=1/0,Oe=0,ri=function(t){t.forEach((function(e){e.interactionId&&(ft=Math.min(ft,e.interactionId),Oe=Math.max(Oe,e.interactionId),on=Oe?(Oe-ft)/7+1:0)}))},cn=function(){return ut?on:performance.interactionCount||0},ii=function(){"interactionCount"in performance||ut||(ut=Z("event",ri,{type:"event",buffered:!0,durationThreshold:0}))},L=[],$e=new Map,un=0,si=function(){var t=Math.min(L.length-1,Math.floor((cn()-un)/50));return L[t]},ai=[],oi=function(t){if(ai.forEach((function(i){return i(t)})),t.interactionId||t.entryType==="first-input"){var e=L[L.length-1],n=$e.get(t.interactionId);if(n||L.length<10||t.duration>e.latency){if(n)t.duration>n.latency?(n.entries=[t],n.latency=t.duration):t.duration===n.latency&&t.startTime===n.entries[0].startTime&&n.entries.push(t);else{var r={id:t.interactionId,latency:t.duration,entries:[t]};$e.set(r.id,r),L.push(r)}L.sort((function(i,s){return s.latency-i.latency})),L.length>10&&L.splice(10).forEach((function(i){return $e.delete(i.id)}))}}},ln=function(t){var e=self.requestIdleCallback||self.setTimeout,n=-1;return t=Fe(t),document.visibilityState==="hidden"?t():(n=e(t),me(t)),n},dn=[200,500],ci=function(t,e){"PerformanceEventTiming"in self&&"interactionId"in PerformanceEventTiming.prototype&&(e=e||{},ve((function(){var n;ii();var r,i=T("INP"),s=function(c){ln((function(){c.forEach(oi);var u=si();u&&u.latency!==i.value&&(i.value=u.latency,i.entries=u.entries,r())}))},a=Z("event",s,{durationThreshold:(n=e.durationThreshold)!==null&&n!==void 0?n:40});r=C(t,i,dn,e.reportAllChanges),a&&(a.observe({type:"first-input",buffered:!0}),me((function(){s(a.takeRecords()),r(!0)})),H((function(){un=cn(),L.length=0,$e.clear(),i=T("INP"),r=C(t,i,dn,e.reportAllChanges)})))})))},gn=[2500,4e3],pt={},ui=function(t,e){e=e||{},ve((function(){var n,r=gt(),i=T("LCP"),s=function(u){e.reportAllChanges||(u=u.slice(-1)),u.forEach((function(h){h.startTime<r.firstHiddenTime&&(i.value=Math.max(h.startTime-xe(),0),i.entries=[h],n())}))},a=Z("largest-contentful-paint",s);if(a){n=C(t,i,gn,e.reportAllChanges);var c=Fe((function(){pt[i.id]||(s(a.takeRecords()),a.disconnect(),pt[i.id]=!0,n(!0))}));["keydown","click"].forEach((function(u){addEventListener(u,(function(){return ln(c)}),{once:!0,capture:!0})})),me(c),H((function(u){i=T("LCP"),n=C(t,i,gn,e.reportAllChanges),dt((function(){i.value=performance.now()-u.timeStamp,pt[i.id]=!0,n(!0)}))}))}}))},fn=[800,1800],li=function t(e){document.prerendering?ve((function(){return t(e)})):document.readyState!=="complete"?addEventListener("load",(function(){return t(e)}),!0):setTimeout(e,0)},di=function(t,e){e=e||{};var n=T("TTFB"),r=C(t,n,fn,e.reportAllChanges);li((function(){var i=lt();i&&(n.value=Math.max(i.responseStart-xe(),0),n.entries=[i],r(!0),H((function(){n=T("TTFB",0),(r=C(t,n,fn,e.reportAllChanges))(!0)})))}))},ye={passive:!0,capture:!0},gi=new Date,pn=function(t,e){M||(M=e,he=t,Zt=new Date,mn(removeEventListener),hn())},hn=function(){if(he>=0&&he<Zt-gi){var t={entryType:"first-input",name:M.type,target:M.target,cancelable:M.cancelable,startTime:M.timeStamp,processingStart:M.timeStamp+he};De.forEach((function(e){e(t)})),De=[]}},fi=function(t){if(t.cancelable){var e=(t.timeStamp>1e12?new Date:performance.now())-t.timeStamp;t.type=="pointerdown"?(function(n,r){var i=function(){pn(n,r),a()},s=function(){a()},a=function(){removeEventListener("pointerup",i,ye),removeEventListener("pointercancel",s,ye)};addEventListener("pointerup",i,ye),addEventListener("pointercancel",s,ye)})(e,t):pn(e,t)}},mn=function(t){["mousedown","keydown","touchstart","pointerdown"].forEach((function(e){return t(e,fi,ye)}))},vn=[100,300],pi=function(t,e){e=e||{},ve((function(){var n,r=gt(),i=T("FID"),s=function(u){u.startTime<r.firstHiddenTime&&(i.value=u.processingStart-u.startTime,i.entries.push(u),n(!0))},a=function(u){u.forEach(s)},c=Z("first-input",a);n=C(t,i,vn,e.reportAllChanges),c&&(me(Fe((function(){a(c.takeRecords()),c.disconnect()}))),H((function(){var u;i=T("FID"),n=C(t,i,vn,e.reportAllChanges),De=[],he=-1,M=null,mn(addEventListener),u=s,De.push(u),hn()})))}))};const hi=d("web-vitals");let yn=!1,wn=!1;const En=[ni,sn,pi,ci,ui,di];async function mi(){wi()&&!wn&&(yi(),wn=!0)}function vi(t){f.emit(k.TRACK_WEB_VITAL,t.name,{metric:t})}function yi(){hi.debug("Setting web-vital listeners",En);for(const t of En)t(vi,{reportAllChanges:!1})}function wi(){return!!window.performance&&!!window.PerformanceObserver}function ze(){yn=!0,window.removeEventListener("click",ze,!0),window.removeEventListener("keydown",ze,!0)}window.addEventListener("click",ze,!0),window.addEventListener("keydown",ze,!0);const kn=d("Laquesis/tracking");function Sn(){return`[${Array.from(o.activeExps).map(([e,n])=>`"${e},${n}"`).join(",")}]`}function bn(){P.push({trackEvent:be.TEST_ASSIGNMENT,test_definition:Sn()})}function Ei(){const t=`[${[...o.activeFlags].map(e=>`"${e}"`).join(",")}]`;P.push({trackEvent:be.FLAG_ASSIGNMENT,flag_definition:t})}function In(t,e){if(o.playgroundMode){kn.debug("Playground mode enabled, skipping tracking impression");return}const n=O();if(!n.currentSession||n.currentSession!==o.currentSession?.session)n.currentSession=o.currentSession.session,n.trackedExperiments="";else if(n.trackedExperiments&&n.trackedExperiments.includes(t))return;n.trackedExperiments=n.trackedExperiments?n.trackedExperiments+Q+t:t,W(n);const r={trackEvent:be.TEST_IMPRESSION,test_name:t,test_variation:e,user_uuid:o.userUUId,user_id:o.userId,laq_lft:n.lastRefresh,laq_nft:n.nextRefresh,test_definition:Sn()};yn||(r.web_vital_page=o.firstTrackedPageEvent),P.push(r),F(D.LAQUESIS_EXP_IMPRESSION,{experiment:t,variant:e}),kn.debug("Impression tracked",r)}const ht=d("Laquesis/playground");function ki(t){const n=window.atob(decodeURIComponent(t)).split(qr);if(n.length<=4){const[r,,i,s]=n;r&&(ht.debug("Enabling the playground mode with experiments:",r),g.set(B.LAQUESIS,r.toLowerCase(),{expires:x(Bt,"min"),path:"/",domain:l().cookieDomain})),i&&(ht.debug("Enabling the playground mode with flags:",i),g.set(B.LAQUESIS_FF,i.toLowerCase(),{expires:x(Bt,"min"),path:"/",domain:l().cookieDomain})),s&&(ht.debug("Enabling the playground mode with a survey:",s),f.emit(p.ASSIGN_QA_SURVEY,"",{surveyId:Number(s)})),(r||i||s)&&(o.playgroundMode=!0,f.emit(k.TRACK_FEATURE_USAGE,"",{message:`laquesis/playground \u2013 experiments: ${r}, flags: ${i}, survey: ${s}`}))}}const Me=d("laquesis/setupWindow");function Si(){window.isVariantEnabled=function(t,e,n){return Ti(t,e,n)},window.getLaquesisVariant=function(t,e){return Ci(t,e)},window.flushImpressions=function(){Ii()},window.isFeatureEnabled=function(t){return _i(t)},window.laquesisSetUserId=function(t){return Ai(t)},window.laquesisDropUserId=function(){return Pi()},window.laquesisSetUserUUId=function(t){return Li(t)},window.laquesisDropUserUUId=function(){return Ri()},window.laquesisGetActive=function(){const t=O();return{experiments:Object.fromEntries(o.activeExps),flags:Array.from(o.activeFlags),surveys:{assigned:o.activeSurveys.map(e=>Number(e.id)),shown:t.showedSurveys.map(Number)}}},f.emit(p.SETUP_SURVEYS_WINDOW,"")}function bi(){window.getLaquesisVariant=function(t){return ot("getLaquesisVariant",t)},window.isVariantEnabled=function(t,e){return window.getLaquesisVariant?window.getLaquesisVariant(t)===e:!1},window.isFeatureEnabled=function(t){return ot("isFeatureEnabled",t)},window.flushImpressions=function(){}}function Ii(){for(const[t,e]of o.impressionsQueue.entries())try{Me.debug(`Flushing delayed impression callback for ${t}`),e()}catch(n){Me.error("Error while flushing impressions",n)}o.impressionsQueue.clear()}function Ti(t,e,n){const r=t.toLowerCase(),i=e.toLowerCase();if(!navigator.cookieEnabled||o.activeExps.get(r)!==i)return!1;const a=()=>{f.emit(p.TRACK_IMPRESSION,"",{expName:r,variantName:i})};return n?(o.impressionsQueue.set(`${r}@${i}`,a),Me.debug(`isVariantEnabled: queued impression for ${r} ${i}`)):a(),!0}function Ci(t,e){if(!navigator.cookieEnabled)return null;const n=t.toLowerCase(),r=o.activeExps.get(n);if(!r)return null;const i=()=>{f.emit(p.TRACK_IMPRESSION,"",{expName:n,variantName:r})};return e?(o.impressionsQueue.set(`${n}@${r}`,i),Me.debug(`getLaquesisVariant: queued impression for ${n} ${r}`)):i(),r}function _i(t){return navigator.cookieEnabled?o.activeFlags.has(t.toLowerCase()):!1}function Ai(t){t&&o.userId!==t&&(o.userId=t,f.emit(p.DEFINITION_RELOAD,""))}function Pi(){o.userId&&(o.userId=void 0,f.emit(p.DEFINITION_RELOAD,""))}function Li(t){t&&o.userUUId!==t&&(o.userUUId=t,f.emit(p.DEFINITION_RELOAD,""))}function Ri(){o.userUUId&&(o.userUUId=void 0,f.emit(p.DEFINITION_RELOAD,""))}const te=d("Laquesis");class Ui extends z{listeners;constructor(){super(),this.trackerName="laquesis",this.listeners={[p.DEFINITION_RELOAD]:()=>Xt(),[p.TRACK_EXP_ASSIGNMENT]:()=>bn(),[p.TRACK_FLAG_ASSIGNMENT]:()=>Ei(),[p.TRACK_IMPRESSION]:e=>In(e.props.expName,e.props.variantName)}}async init(){if(!this.isInitialized){if(l().isNative)bi(),te.debug("Native window was set up");else{if(!o.currentSession?.sessionLong){te.debug("No session long available. Laquesis initialization aborted");return}await Tn(),Si(),typeof window.laquesisFunctionsCallback=="function"&&(te.debug("Calling laquesisFunctionsCallback()",window.laquesisFunctionsCallback),window.laquesisFunctionsCallback()),Wr(mt),Wt(mt),F(D.LAQUESIS_READY),te.debug("Laquesis initialized"),Cn()}this.isInitialized=!0}return this}async setupListeners(){return l().isNative||(super.setupListeners(),this.isInitialized||await this.init()),this}async trackEvent(){}async trackPage(){}}async function Tn(){try{const t=new URL(window.location.href).searchParams.get("laquesisqahash");if(t&&(te.debug("Laquesis qa hash detected."),ki(t)),E.userId&&(o.userId=E.userId),E.userUUId&&(o.userUUId=E.userUUId),f.emit(p.INIT_SURVEYS_STORAGE,""),_n(),o.isLQRefreshNeeded&&!o.playgroundMode)await Xt();else{const e=g.get(B.LAQUESIS);if(e&&(o.activeExps=at(e,mt),o.cookieFromLq)){o.cookieFromLq=!1;const r=e.replace(/^"(.+)"$/,"$1");g.set(B.LAQUESIS,r,{expires:x(1,"year"),path:"/",domain:l().cookieDomain}),f.emit(k.TRACK_FEATURE_USAGE,"",{message:"laquesis/lqonap"}),bn()}const n=g.get(B.LAQUESIS_FF);n&&(o.activeFlags=Kt(n))}}catch(t){throw te.error("Laquesis initialization error",t),t}}function Cn(){setTimeout(async()=>{_n(),o.isLQRefreshNeeded&&await Tn(),Cn()},1e3*60)}function _n(){const t=O();t.nextRefresh-Date.now()<0&&(o.isLQRefreshNeeded=!0),t.isDefinitionsForUserId!==!!o.userId&&(o.isLQRefreshNeeded=!0,t.isDefinitionsForUserId=!!o.userId,W(t)),t.isDefinitionsForUUId!==!!o.userUUId&&(o.isLQRefreshNeeded=!0,t.isDefinitionsForUUId=!!o.userUUId,W(t))}function mt(t,e){In(t,e),F(D.LAQUESIS_EXP_IMPRESSION,{experiment:t,variant:e})}const K=d("Surveys/storage");function Ni(){if(o.playgroundMode)return;localStorage.removeItem(Or),localStorage.removeItem($r);const t=localStorage.getItem(it)||"",e=Di(t);if(!e){K.debug("No surveys data found in local storage, setting refresh flag to true"),o.isLQRefreshNeeded=!0;return}Ge(e)}function Di(t){if(!t)return null;try{const e=JSON.parse(t);if(K.debug("Parsed surveys data from local storage",e),Array.isArray(e))return e}catch(e){K.error("Failed to parse surveys data from local storage",e)}return null}async function An(t,e=""){if(e)return ce(e);const n={id:t.toString(),cc:m().params?.cC,br:m().params?.bR,ch:l().platform},r=`${kt}/survey?${fe(n)}`;return ce(r)}async function xi(t){const e=await An(t);if(!e){K.debug("Survey data not found");return}Ge([e])}function Ge(t){const e=O(),r=[...t].sort((i,s)=>i.id.toString().localeCompare(s.id.toString())).map(i=>({id:Number(i.id),triggers:i.triggers,type:i.type}));o.activeSurveys=r,window.localStorage.setItem(it,JSON.stringify(r)),K.debug("laquesissu updated",r),o.surveyTriggerMap=Fi(r),e.showedSurveys=e.showedSurveys.filter(i=>t.some(s=>s.id.toString()===i)),W(e)}function Fi(t){const e=t.reduce((n,r)=>(r.triggers.forEach(({event_name:i})=>{n[i]=n[i]??[],n[i].push(r.id)}),n),{});return K.debug("Survey trigger map created",e),e}function Pn(t){return K.debug("Getting survey from active surveys",t,o.activeSurveys),o.activeSurveys.find(e=>e.id.toString()===t.toString())}function qi(t){return o.surveyTriggerMap[t]??[]}function Oi(){Ge([]),localStorage.removeItem(it)}const y=d("Surveys/conditions");function vt(t){const e=Pn(t);return e?o.playgroundMode||e.type==="feedback"?(y.debug("In playground mode or feedback survey",t),!0):!Ln(t)&&!$i():(y.debug("Survey not assigned to the current user",t),!1)}function $i(){const t=O();return y.debug("Checking if in lockout period",Date.now()<=t.nextSurveyShow*1e3,t.nextSurveyShow),Date.now()<=t.nextSurveyShow*1e3}function Ln(t){if(!t)return!1;const e=O();return y.debug("Checking if survey is already shown",t,e.showedSurveys),e.showedSurveys.includes(t.toString())}async function zi(t){const e=qi(t.value);if(!e.length){y.debug("No surveys to trigger for the current event",t.value);return}for(const n of e){if(o.triggeredSurvey){y.debug("Another survey already active");break}Mi(n,t)?f.emit(p.TRIGGER_SURVEY,"",{surveyId:n}):y.debug("Survey can not be shown")}}function Mi(t,e){const n=Pn(t);if(!n)return y.debug("Survey does not exist",t),!1;if(n.type==="feedback")return y.debug("Showing feedback survey",t),!0;if(!vt(t))return y.debug("Survey not available",t),!1;const r=n.triggers?.filter(s=>s.event_name===e.value)||[];if(!r.length)return y.debug("No matching event triggers",n,e),!1;const i=r.some(s=>Gi(s,e));return i||y.debug("No matching property trigger",r,e),i}function Gi(t,e){if(!t.conditions?.length)return!0;const n=e.props||{},r=Vt(e);return n.sl=e.meta?.sessionParams.sessionLong,n.s=e.meta?.sessionParams.session,n.cl=e.meta?.sessionParams.sessionCountLong,n.c=e.meta?.sessionParams.sessionCount,n.cp=decodeURIComponent(et()),n.cc=r.cC,n.br=r.bR,t.conditions.every(i=>Vi(i,n))}function Vi(t,e){return t.some(n=>{const r=n.c?g.get(n.n):e[n.n],i=ji(n,r);return y.debug("Evaluating condition",n,r,i),i})}function ji(t,e){if(t.o==="is_null")return e==null;if(t.o==="is_not_null")return e!=null;if(e==null)return!1;switch(t.o){case"equals":return e.toString()===t.v.toString();case"not_equals":return e.toString()!==t.v.toString();case"greater_than":return Number(e)>Number(t.v);case"less_than":return Number(e)<Number(t.v);default:return!1}}function Qi(t){const e=O(),n=t.config?.next_survey_allowed_in_sec||0;if(o.playgroundMode||Ln(t.id)){y.debug("NOT Mark survey as shown - playground mode or shown already",t);return}t.type==="default"&&(e.showedSurveys.push(t.id.toString()),e.nextSurveyShow=Date.now()/1e3+n,W(e),y.debug(`Mark survey as shown, next lockout at ${e.nextSurveyShow}`,t))}const Bi=d("Surveys/scriptLoader");let Rn=!1;async function Hi(){if(!Rn)try{await Pe(Mn,"laquesisSurvey"),Rn=!0}catch(t){throw Bi.error("Loading survey script failed",t),new Error("Loading survey script failed")}}const Un=d("Surveys/stylesLoader");let Nn=!1;async function Ki(){const t=l();if(!(!t.asyncSurveyStyles||Nn))try{const e=t.surveyTheme||"default",n=`${Gn}-${e}.css`,r=`${Qe}/${n}`;await wr(r,"laquesisSurveyStyles"),Un.debug("Loaded survey styles",r),Nn=!0}catch(e){throw Un.error("Failed to load survey styles",e),new Error("Failed to load survey styles")}}const Dn=d("Surveys/display");async function Yi(t,e=""){if(o.triggeredSurvey){Dn.debug("Another survey already active, triggering aborted.");return}const n=Date.now();try{const[r]=await Promise.all([An(t,e),Ki(),Hi()]);o.triggeredSurvey=r,await Wi(r,n),console.assert(typeof window.laquesisSurvey=="function","laquesisSurvey not found in window!"),F(D.LAQUESIS_SURVEY_SHOW,{id:r.id}),window.laquesisSurvey(r,f,o.playgroundMode),o.playgroundMode||Qi(r)}catch(r){throw o.triggeredSurvey=void 0,Dn.error("Failed to trigger survey",r),r}}async function Wi(t,e){if(!t)throw new Error("No survey data provided");const n=t.config?.delay_render_in_sec?t.config.delay_render_in_sec*1e3:3e3,r=Date.now()-e,i=Math.max(0,n-r);await new Promise(s=>setTimeout(s,i))}const xn=d("Surveys");class Ji extends z{constructor(){super(),this.trackerName="surveys",this.listeners={[p.INIT_SURVEYS_STORAGE]:()=>Ni(),[p.ASSIGN_QA_SURVEY]:e=>xi(e.props.surveyId),[p.ASSIGN_SURVEYS]:e=>Ge(e.props.surveys),[p.SETUP_SURVEYS_WINDOW]:()=>Xi(),[p.CHECK_SURVEYS_FOR_TRIGGER]:e=>zi(e),[p.TRIGGER_SURVEY]:e=>Yi(e.props.surveyId,e.props.link),[p.CLOSE_SURVEY]:()=>{F(D.LAQUESIS_SURVEY_CLOSE,{id:o.triggeredSurvey?.id}),o.triggeredSurvey=void 0},[p.TRACK_SURVEY_TRIGGER]:e=>f.emit(k.TRACK_SURVEY,e.value,e.props)}}async init(){if(!yr()){this.cleanup(),Oi();return}return this.isInitialized=!0,xn.debug("surveys initialized"),this}async setupListeners(){return await super.setupListeners(),this.isInitialized||await this.init(),this}async trackEvent(){}async trackPage(){}}function Xi(){window.laquesisShowSurvey=function(t){if(!vt(t))return Promise.reject("Survey not available, already shown or in lockout period");o.playgroundMode=!1,xn.debug("Survey triggered manually using window.laquesisShowSurvey",t),f.emit(p.TRIGGER_SURVEY,"",{surveyId:t}),f.emit(k.TRACK_FEATURE_USAGE,"",{message:"surveys/function trigger"})},window.isSurveyAvailable=function(t){return vt(t)},window.laquesisShowSurveyByLink=function(t){o.playgroundMode=!0,f.emit(p.TRIGGER_SURVEY,"",{surveyId:0,link:t})}}function Zi(t,e,n,r,i,s,a){t.braze={},t.brazeQueue=[];for(var c="BrazeSdkMetadata DeviceProperties Card Card.prototype.dismissCard Card.prototype.removeAllSubscriptions Card.prototype.removeSubscription Card.prototype.subscribeToClickedEvent Card.prototype.subscribeToDismissedEvent Card.fromContentCardsJson Banner CaptionedImage ClassicCard ControlCard ContentCards ContentCards.prototype.getUnviewedCardCount Feed Feed.prototype.getUnreadCardCount ControlMessage InAppMessage InAppMessage.SlideFrom InAppMessage.ClickAction InAppMessage.DismissType InAppMessage.OpenTarget InAppMessage.ImageStyle InAppMessage.Orientation InAppMessage.TextAlignment InAppMessage.CropType InAppMessage.prototype.closeMessage InAppMessage.prototype.removeAllSubscriptions InAppMessage.prototype.removeSubscription InAppMessage.prototype.subscribeToClickedEvent InAppMessage.prototype.subscribeToDismissedEvent InAppMessage.fromJson FullScreenMessage ModalMessage HtmlMessage SlideUpMessage User User.Genders User.NotificationSubscriptionTypes User.prototype.addAlias User.prototype.addToCustomAttributeArray User.prototype.addToSubscriptionGroup User.prototype.getUserId User.prototype.incrementCustomUserAttribute User.prototype.removeFromCustomAttributeArray User.prototype.removeFromSubscriptionGroup User.prototype.setCountry User.prototype.setCustomLocationAttribute User.prototype.setCustomUserAttribute User.prototype.setDateOfBirth User.prototype.setEmail User.prototype.setEmailNotificationSubscriptionType User.prototype.setFirstName User.prototype.setGender User.prototype.setHomeCity User.prototype.setLanguage User.prototype.setLastKnownLocation User.prototype.setLastName User.prototype.setPhoneNumber User.prototype.setPushNotificationSubscriptionType InAppMessageButton InAppMessageButton.prototype.removeAllSubscriptions InAppMessageButton.prototype.removeSubscription InAppMessageButton.prototype.subscribeToClickedEvent FeatureFlag FeatureFlag.prototype.getStringProperty FeatureFlag.prototype.getNumberProperty FeatureFlag.prototype.getBooleanProperty automaticallyShowInAppMessages destroyFeed hideContentCards showContentCards showFeed showInAppMessage toggleContentCards toggleFeed changeUser destroy getDeviceId initialize isPushBlocked isPushPermissionGranted isPushSupported logCardClick logCardDismissal logCardImpressions logContentCardImpressions logContentCardClick logContentCardsDisplayed logCustomEvent logFeedDisplayed logInAppMessageButtonClick logInAppMessageClick logInAppMessageHtmlClick logInAppMessageImpression logPurchase openSession requestPushPermission removeAllSubscriptions removeSubscription requestContentCardsRefresh requestFeedRefresh refreshFeatureFlags requestImmediateDataFlush enableSDK isDisabled setLogger setSdkAuthenticationSignature addSdkMetadata disableSDK subscribeToContentCardsUpdates subscribeToFeedUpdates subscribeToInAppMessage subscribeToSdkAuthenticationFailures toggleLogging unregisterPush wipeData handleBrazeAction subscribeToFeatureFlagsUpdates getAllFeatureFlags".split(" "),u=0;u<c.length;u++){for(var h=c[u],v=t.braze,re=h.split("."),je=0;je<re.length-1;je++)v=v[re[je]];v[re[je]]=new Function("return function "+h.replace(/\./g,"_")+"(){window.brazeQueue.push(arguments); return true}")()}return window.braze.getCachedContentCards=function(){return new window.braze.ContentCards},window.braze.getCachedFeed=function(){return new window.braze.Feed},window.braze.getUser=function(){return new window.braze.User},window.braze.getFeatureFlag=function(){return new window.braze.FeatureFlag},Pe(s,a,void 0,{"data-ot-ignore":""})}const b=d("BrazeTracker");class es extends z{isDisabled;constructor(){super(),this.isDisabled=!1,this.isInitPushed=!1,this.trackerName="braze",this.scriptTagId="braze-script-tag",this.scriptUrl="https://js.appboycdn.com/web-sdk/5.7/braze.min.js",this.listeners={trackEvent:e=>this.initAndExecute(()=>this.trackEvent(e)),trackPage:e=>this.initAndExecute(()=>this.trackPage(e)),trackLinkEvent:e=>this.initAndExecute(()=>this.trackLinkEvent(e))}}async init(){try{if(!this.hasRequiredConsent())return this;const e=this.getToken(),n=this.getEndpoint(),r=document.getElementById(this.scriptTagId);this.isInitPushed=!!r,this.isInitPushed?this.isDisabled&&window.braze&&this.enableAndInitialize(e,n):(this.isInitPushed=!0,await Zi(window,document,"script",null,null,this.scriptUrl,this.scriptTagId),window.braze?(this.enableAndInitialize(e,n),typeof window.brazeInitCallback=="function"&&window.brazeInitCallback(window.braze),F(D.BRAZE_INIT,window.braze),this.isInitialized=!0,b.debug("Braze tracker initialized")):b.debug("window.braze is missing after init"))}catch(e){throw b.error("Braze tracker initialization error",e),e}return this}async trackEvent(e){if(!this.hasRequiredConsent()){this.cleanup(),b.debug("No consent from the user. Event tracking aborted",e);return}if(!this.isInitialized)try{await this.init()}catch(r){b.error("Failed to initialize Braze tracker. Event tracking aborted",r);return}const n=S(this.trackerName,"trackEvent",this.convertString(e.value));if(!n){b.debug("Values not found in the mapping. Event tracking aborted",e.value);return}if(window.braze&&typeof window.braze.logCustomEvent=="function"){const r=this.getTrackParams(e);window.braze.logCustomEvent(n.value,r)?b.debug("Braze event tracked",e.actionType,e.value,e.props):b.debug("Braze event tracking failed",e.actionType,e.value,e.props)}}async trackPage(e){if(!this.hasRequiredConsent()){this.cleanup(),b.debug("No consent from the user. Page tracking aborted",e);return}if(!this.isInitialized)try{await this.init()}catch(r){b.error("Failed to initialize Braze tracker. Page tracking aborted",r);return}const n=S(this.trackerName,"trackPage",e.value);if(!n){b.debug("Values not found in the mapping. Page tracking aborted",e.value);return}if(window.braze&&typeof window.braze.logCustomEvent=="function"){const r=this.getTrackParams(e);window.braze.logCustomEvent(n.value,r)?b.debug("Braze page tracked",e.actionType,e.value,e.props):b.debug("Braze page tracking failed",e.actionType,e.value,e.props)}}getEndpoint(){return _()?.custom?.[l().siteUrl]?.config?.[N.braze]?.endpoint}enableAndInitialize(e,n){this.isDisabled=!1,window.braze?.isDisabled()&&window.braze?.enableSDK(),window.braze?.initialize(e,{baseUrl:n,enableLogging:l().environment!=="production",doNotLoadFontAwesome:!0,allowUserSuppliedJavascript:!0})}cleanup(){super.cleanup(),window.braze&&(window.braze.disableSDK(),this.isDisabled=!0)}convertString(e){return typeof e!="string"?e:e.toLowerCase().replace(/[^a-z0-9/_]+/g,"-").replace(/\s+/g,"-").replace(/-+/g,"-")}}let yt;const ts=d("configs/comperia");function ns(){try{if(!yt){const t=_(),e=t.config[N.comperia],n=t.custom?.[l().siteUrl]?.config[N.comperia];yt=n?{...e,...n}:e}}catch(t){ts.debug("Error getting comperia config",t)}return yt}function Fn(t,e){const n={};n.sl=t.meta?.sessionParams?.sessionLong,n.s=t.meta?.sessionParams?.session,n.cl=t.meta?.sessionParams?.sessionCountLong,n.c=t.meta?.sessionParams?.sessionCount,t.meta?.sessionParams?.noCookie&&(n.nc=1),n.t=t.t??Date.now(),n.consent=Ye().filter(i=>i!==V.C0001).join(","),t.meta?.invite&&(n.iv=t.meta.invite),t.meta?.host&&(n.host=t.meta.host),t.meta?.hash&&(n.hash=t.meta.hash),t.meta?.referrer&&(n.referer=t.meta.referrer);const r=m();return n.ivd="olx-"+r.params?.cC.toLowerCase()+"_organic",r.params?.rE!==void 0&&(n.rE=r.params.rE),e&&(n.cP=e),l().unitTest||(n.js=1),n.as=rs(),n}function rs(){return document.hasFocus()?He.ACTIVE:document.hidden?He.HIDDEN:He.INACTIVE_VISIBLE}const we=d("ComperiaTracker"),Ve=q("sceuidjs"),qn="sceuidjs_ok";class is extends z{lastTrackedPageName="";comperiaConfig=null;constructor(){super(),this.trackerName="comperia",this.listeners={trackEvent:e=>this.initAndExecute(()=>this.trackEvent(e)),trackPage:e=>this.initAndExecute(()=>this.trackPage(e))}}async init(){if(!this.hasRequiredConsent())return this.cleanup(),this.isInitialized=!0,this;if(this.isInitialized)return we.debug("ComperiaTracker already initialized",this.isInitialized),this;if(this.comperiaConfig=ns(),!this.comperiaConfig||!this.comperiaConfig.sce_endpoint||!this.comperiaConfig.sce_sid||!this.comperiaConfig.endpoint)return we.debug("Comperia tracker configuration incomplete"),this.isInitialized=!0,this;try{await this.setSceuidCookie()}catch(e){we.error("Error initializing Comperia tracker:",e.message)}return this.isInitialized=!0,this}async setSceuidCookie(){const e=g.get(Ve),n=localStorage.getItem(qn)==="1";if(e&&n)return e;const r={eventType:"set_cookie",__additional:{timestamp:Date.now(),sid:this.comperiaConfig?.sce_sid,url:location.href,referrer:document.referrer}},i=`${this.comperiaConfig?.sce_endpoint}/api/scenario/code/remote/score?name=setCookie&key=${this.comperiaConfig?.sce_code}`,s=await fetch(i,{method:"POST",credentials:"include",headers:{"Content-Type":"application/json; charset=UTF-8",Accept:"application/json"},body:JSON.stringify(r)});if(!s.ok)throw new Error(`HTTP error: ${s.status}`);const a=await s.json();if(!a.sceuid)throw new Error("No sceuid in response");const c=l();return g.set(Ve,a.sceuid,{expires:x(1,"year"),path:"/",domain:c.cookieDomain}),localStorage.setItem(qn,"1"),a.sceuid}async doTracking(e){const n=g.get(Ve);if(!n){we.debug("SCEUIDJS cookie not found, cannot track Comperia event");return}const r=this.getParams(e);if(!r||Object.keys(r).length===0)return;const i=Object.fromEntries(Object.entries(r).filter(([,h])=>h!=null)),s={name:this.comperiaConfig?.name,key:this.comperiaConfig?.code,sceuid:n},a=Object.assign({},i,s),c=fe(a),u=`${this.comperiaConfig?.endpoint}?${c}`;await fetch(u,{method:"GET",headers:{"Content-Type":"application/json"}})}async trackEvent(e){this.isInitialized||await this.init();try{await this.doTracking(e)}catch{}}async trackLinkEvent(e){this.isInitialized||await this.init();try{await this.doTracking(e)}catch{}}async trackPage(e){this.isInitialized||await this.init();try{await this.doTracking(e)}catch{}}getParams(e){const n={},r=S(this.trackerName,e.actionType,e.value);if(r){const i=this.getDefaultParams(e),s=this.getTrackParams(e,i);for(const[a,c]of Object.entries(s))Array.isArray(c)?n[a]=JSON.stringify(c):n[a]=c;return r.key&&(n[r.key]=r.value),n}return we.debug("Unknown event",e.actionType,e.value,e.props),{}}getDefaultParams(e){return e.actionType==="trackPage"&&(this.lastTrackedPageName=et()),Fn(e,this.lastTrackedPageName)}cleanup(){super.cleanup(),g.remove(Ve)}}const R=d("FacebookTracker");class ss extends z{constructor(){super(),this.scriptUrl="https://www.facebook.com/tr",this.trackerName="facebook",this.listeners={trackEvent:e=>this.initAndExecute(()=>this.trackEvent(e)),trackPage:e=>this.initAndExecute(()=>this.trackPage(e)),trackLinkEvent:e=>this.initAndExecute(()=>this.trackLinkEvent(e))}}async init(){try{return this.hasRequiredConsent()?(this.isInitialized||(this.isInitialized=!0,R.debug("Facebook tracker initialized")),this):this}catch(e){throw R.error("Facebook tracker initialization error",e),e}}async trackEvent(e){if(!this.hasRequiredConsent()){R.debug("No consent from the user. Event tracking aborted",e);return}if(!this.isInitialized)try{await this.init()}catch(i){R.error("Failed to initialize Facebook tracker. Event tracking aborted",i);return}const n=S(this.trackerName,"trackEvent",e.value);if(!n){R.debug("Values not found in the mapping. Event tracking aborted",e.value);return}const r=this.getUrl(n.value,e);r&&(await fetch(r),R.debug("Facebook event tracked",e.actionType,e.value,e.props))}async trackPage(e){if(!this.hasRequiredConsent()){R.debug("No consent from the user. Page tracking aborted",e);return}if(!this.isInitialized)try{await this.init()}catch(s){R.error("Failed to initialize Facebook tracker. Page tracking aborted",s);return}const n=S(this.trackerName,"trackPage",e.value);if(!n){R.debug("Values not found in the mapping. Page tracking aborted",e.value);return}const r=decodeURIComponent(n.value),i=this.getUrl(r,e);i&&(await fetch(i),R.debug("Facebook page tracked",e.actionType,e.value,e.props))}getUrl(e,n){const r={id:this.getToken(),ev:e},i=fe(r),s=this.getUrlParams(n);return`${this.scriptUrl}?${i}${s}`}getUrlParams(e){const n=Object.entries(Ue(this.trackerName,e.props)).reduce((r,[i,s])=>(r[encodeURIComponent(i)]=encodeURIComponent(s),r),{});return Object.entries(n).map(([r,i])=>`&cd[${r}]=${i}`).join("")}}function as(t,e){window[e]=window[e]||[],window.gtag=function(...i){window[e].push(i)},_t(e);const n=_()?.custom?.[l().siteUrl].config[N.ga]?.cross_domains;n&&window.gtag("set","linker",{domains:n}),window.gtag("js",new Date),window.gtag("config",t,{anonymize_ip:!0})}const I=d("GaTracker");class os extends z{customDataLayer;constructor(){super(),this.isInitPushed=!1,this.trackerName="ga",this.scriptTagId="ga-script-tag",this.scriptUrl="https://www.googletagmanager.com/gtag/js",this.customDataLayer="gtagDataLayer",this.listeners={trackEvent:e=>this.initAndExecute(()=>this.trackEvent(e)),trackPage:e=>this.initAndExecute(()=>this.trackPage(e)),trackLinkEvent:e=>this.initAndExecute(()=>this.trackLinkEvent(e))}}async init(){if(!this.hasRequiredConsent())return this.cleanup(),this;const e=this.getToken();if(!e)return Promise.reject("No token found for GA tracker");const n=document.getElementById(this.scriptTagId);if(this.isInitPushed=!!n,!this.isInitPushed){this.isInitPushed=!0,window[`ga-disable-${e}`]=!1,as(e,this.customDataLayer);try{const r=this.scriptUrl+"?l="+this.customDataLayer;await Pe(r,this.scriptTagId),this.isInitialized=!0,I.debug("GA tracker initialized")}catch(r){throw I.error("GA tracker initialization error",r),this.isInitialized=!1,this.cleanup(),r}}return this}async trackEvent(e){if(!this.hasRequiredConsent()){this.cleanup(),I.debug("No consent from the user. Event tracking aborted",e);return}if(!this.isInitialized)try{await this.init()}catch(i){I.error("Failed to initialize GA tracker. Event tracking aborted",i);return}const n=S(this.trackerName,"trackEvent",this.convertString(e.value));if(!n){I.debug("Values not found in the mapping. Event tracking aborted",e.value);return}const r=n.value.substring(0,n.value.indexOf("_"));try{window.gtag("event",n.value,{debug_mode:l().debug,eventLabel:n.value,eventCategory:r||"default",...this.getTrackParams(e)}),I.debug("GA event tracked",e.actionType,e.value,e.props)}catch(i){I.error("Failed to track GA event",i,e.actionType,e.value,e.props)}}async trackPage(e){if(!this.hasRequiredConsent()){this.cleanup(),I.debug("No consent from the user. Page tracking aborted",e);return}if(!this.isInitialized)try{await this.init()}catch(i){I.error("Failed to initialize GA tracker. Page tracking aborted",i);return}if(!e.value){I.debug("Page name missing. Page tracking aborted");return}const n=S(this.trackerName,"trackPage",e.value);if(!n){I.debug("Values not found in the mapping. Page tracking aborted",e.value);return}const r=this.convertPageNameString(decodeURIComponent(n.value));try{window.gtag("event","page_view",{page_title:r,page_path:window.location.pathname,...this.getTrackParams(e)}),I.debug("GA page tracked",e.actionType,r,e.props)}catch(i){I.error("Failed to track GA page",i,e.actionType,r,e.props)}}cleanup(){super.cleanup(),window[`ga-disable-${this.getToken()}`]=!0}convertString(e){return typeof e!="string"?e:e.toLowerCase().replace(/\s+|[-/]/g,"_")}convertPageNameString(e){return typeof e!="string"?e:e.replace(/[^a-zA-Z0-9/]/g,"_")}}const w=d("GtmTracker");class cs extends z{cookies;isInitPushed=!1;scriptTagId="gtm-script-tag";scriptUrl="https://www.googletagmanager.com/gtm.js?id=";constructor(){super(),this.trackerName="gtm",this.cookies=["invite","ldTd"],this.listeners={trackEvent:e=>this.initAndExecute(()=>this.trackEvent(e)),trackPage:e=>this.initAndExecute(()=>this.trackPage(e)),trackLinkEvent:e=>this.initAndExecute(()=>this.trackLinkEvent(e))}}async init(){if(this.isDisabled())return this;if(this.isInitPushed)return this;const e=document.getElementById(this.scriptTagId);if(this.isInitPushed=!!e,window[`ga-disable-${this.getToken()}`]=!1,!this.isInitPushed){_t(),window.dataLayer.push({processed:!0,"gtm.start":new Date().getTime(),event:"gtm.js"});try{const n=this.scriptUrl+this.getToken();await Pe(n,this.scriptTagId),this.isInitPushed=!0,w.debug("GTM script loaded")}catch(n){throw w.error("GTM tracker initialization error",n),this.isInitialized=!1,n}w.debug("GTM tracker initialized")}return this.isInitialized=!0,this}isDisabled(){return!this.hasRequiredConsent()||!!l().custom?.gtm?.disable}async prepareGtmForTracking(e){const n=document.getElementById(this.scriptTagId);if(this.isInitPushed=!!n,!this.isInitPushed){let r=!0;for(const s of window.dataLayer)(s.trackPage!==void 0||s.trackEvent!==void 0)&&(r=!1);const i=await this.getCustomParams(e,r);i&&window.dataLayer.push({...i,processed:!0})}return this.init()}async trackEvent(e){if(this.isDisabled()){this.cleanup(),w.debug("No consent from the user. Event tracking aborted",e);return}if(!this.isInitialized)try{await this.prepareGtmForTracking(e)}catch(i){w.error("Failed to initialize GTM tracker. Event tracking aborted",i);return}const n=encodeURIComponent(this.convertString(e.value)),r=S(this.trackerName,"trackEvent",n);if(!r){w.debug("Values not found in the mapping. Event tracking aborted",e.value);return}try{window.dataLayer.push({processed:!0,event:r.value}),w.debug("GTM event tracked",e.actionType,n,e.props)}catch(i){w.error("Failed to track GTM event",i,e.actionType,n,e.props)}}async trackPage(e){if(this.isDisabled()){this.cleanup(),w.debug("No consent from the user. Page tracking aborted",e);return}if(!this.isInitialized)try{await this.prepareGtmForTracking(e)}catch(r){w.error("Failed to initialize GTM tracker. Page tracking aborted",r);return}const n=S(this.trackerName,"trackPage",e.value);if(!n){w.debug("Values not found in the mapping. Page tracking aborted",e.value);return}try{window.dataLayer.push({processed:!0,event:n.value}),w.debug("GTM page tracked",e.actionType,e.value,e.props)}catch(r){w.error("Failed to track GTM page",r,e.actionType,e.value,e.props)}}cleanup(){super.cleanup(),this.cookies.forEach(e=>Ze(e)),window[`ga-disable-${this.getToken()}`]=!0}convertString(e){return typeof e!="string"?e:e.toLowerCase().replace(/[^a-z0-9/_]+/g,"-").replace(/\s+/g,"-").replace(/-+/g,"-")}async getCustomParams(e,n){let r={};n&&(r=this.getTrackParams(e),e.actionType==="trackPage"&&e.value&&(r.trackPage=e.value));const i=q("ldTd"),s=await this.handleInviteParams(e);s.length>1&&(r.invs=s[1].toLowerCase(),r.invc=s[2].toLowerCase(),f.emit(k.TRACK_FEATURE_USAGE,"",{message:"GtmTracker/invite params available"}));try{(g.get(i)||"").match(/true/)===null&&(g.set(i,"true",{expires:x(1,"min"),path:"/",domain:l().cookieDomain}),r.landing_page="true")}catch(a){w.error("Failed to handle landing page",a,e)}return Object.keys(r).length===0?null:r}async handleInviteParams(e){const n=q("invite"),r=e.meta?.invite?.match(/^\s*([a-zA-Z0-9-]{1,64})(?:_([a-zA-Z0-9%-]{0,128})).*/);try{if(r){const i=new Date,s=`"sr=${r[1]}&cn=${r[2]}&td=${Math.floor(i.getTime()/1e3)}"`;return g.set(n,s,{expires:30,path:"/",domain:l().cookieDomain}),r}else{const i=(g.get(n)||"").match(/"sr=([A-Za-z0-9-]+)&cn=([A-Za-z0-9%-]+)&td=[0-9]+"/);if(i)return i}}catch(i){w.error("Failed to handle invite",i,e)}return[]}}const wt=d("utils/track");async function Ee(t,e){if(l().isNative)return wt.info("Try to track while in Native env"),!1;const n=Object.fromEntries(Object.entries(e).filter(([,s])=>s!=null)),r=fe(n),i=JSON.stringify([n]);return typeof navigator.sendBeacon=="function"?(navigator.sendBeacon(t,i),wt.debug("Track with Beacon",n.tN,n.eN,n),!0):(wt.debug("Track with keepalive fetch",t,r,n),await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:i,keepalive:!0}),!0)}const G=d("HydraTracker");class us extends z{lastTrackedPageName="";webPushEvents=["pushRcv","pushOpn","pushDis"];constructor(){super(),this.trackerName="hydra",this.listeners={trackEvent:e=>this.initAndExecute(()=>this.trackEvent(e)),trackPage:e=>this.initAndExecute(()=>this.trackPage(e)),trackLinkEvent:e=>this.initAndExecute(()=>this.trackLinkEvent(e)),trackPerformanceEvent:e=>this.initAndExecute(()=>this.trackPerformanceEvent(e)),[k.TRACK_WEB_VITAL]:e=>this.trackWebVital(nt(e)),[k.TRACK_FEATURE_USAGE]:e=>this.trackFeatureUsage(nt(e)),[k.TRACK_SURVEY]:e=>this.trackSurvey(nt(e))}}async init(){return this.isInitialized=!0,G.debug("Hydra tracker initialized"),this}getUrl(e,n){if(!n)return"";const r=S("hydra",e.actionType,e.value);return`${Be}/${n}/${r?.value}`}async doTracking(e){const n=this.getParams(e);if(n){const r=this.getUrl(e,m().path);f.emit(p.CHECK_SURVEYS_FOR_TRIGGER,e.value,e.props,e.meta),await Ee(r,n)}}async trackEvent(e,n=!1){if(this.isInitialized||await this.init(),n){const r=e.props.linkCallBack,i=e.props.linkErrorCallBack;try{delete e.props.linkCallBack,delete e.props.linkErrorCallBack,await this.doTracking(e),typeof r=="function"&&r()}catch(s){typeof i=="function"&&i(s)}}else await this.doTracking(e);G.debug("Hydra event tracked",e.actionType,e.value,e.props,`isLinkEvent=${n}`)}async trackPage(e){this.isInitialized||await this.init(),await this.doTracking(e),m().vitals&&m().vitals_path&&o.firstTrackedPageEvent&&await mi(),G.debug("Hydra page tracked",e.actionType,e.value,e.props)}async trackLinkEvent(e){this.isInitialized||await this.init();const n={...e,actionType:"trackEvent"};await this.trackEvent(n,!0),G.debug("Hydra link event tracked",e.actionType,e.value,e.props)}async trackPerformanceEvent(e){if(!m().vitals_path)return!1;this.isInitialized||await this.init();const n={...e,actionType:"trackEvent"},r=this.getParams(n,!0);if(r){const i=this.getUrl(n,m().vitals_path);return await Ee(i,r),G.debug("Hydra performance event tracked",e.actionType,e.value,e.props),f.emit(k.TRACK_FEATURE_USAGE,"",{message:"hydra/trackPerformanceEvent"}),!0}else G.warn("No params for performance event",e,r);return!1}async trackFeatureUsage(e){const n=`${Be}/${zn}`,r=this.getParams({...e,actionType:"trackEvent",value:e.value||"ninja_debug",props:{}},!0);return r?(Object.assign(r,{eN:"ninja_debug",message:e.props.message,is_native:l().isNative,git_tag:'""',git_revision:'"517f2a47"',git_branch:'""'}),Ee(n,r),!0):!1}async trackWebVital(e){if(l().isNative)return G.info("Try to track while in Native env"),!1;const n=`${Be}/${m().vitals_path}`,r=this.getParams({...e,actionType:"trackEvent",value:"web_vital",props:{}},!0);if(r){const i=e.props.metric;Object.assign(r,{eN:"web_vital",web_vital_name:i.name,web_vital_value:i.value,web_vital_rating:i.rating,web_vital_page:o.firstTrackedPageEvent}),Ee(n,r)}return!0}async trackSurvey(e){const n={...e,actionType:"trackEvent"},r=this.getParams(n,!0);if(r){const i=this.getUrl(n,m().survey_path);Object.assign(r,{cH:o.currentPlatform||"web",survey_id:e.props.surveyId,survey_type:e.props.type,survey_page_id:e.props.surveyPageId}),l().environment!=="production"&&(r.env="dev"),e.props.questionId&&(r.survey_question_id=e.props.questionId),e.props.questionValue&&(r.survey_question_value=e.props.questionValue),Ee(i,r)}}applyPlatform(e){const n=m().platform_property||"platform",r=l().platform,i={...e};return r=="m"?(i[n]=Se.Mobile,o.currentPlatform=Se.Mobile):r==="d"?(i[n]=Se.Desktop,o.currentPlatform=Se.Desktop):i[n]?i[n]!==o.currentPlatform&&(o.currentPlatform=i[n]):o.currentPlatform&&(i[n]=o.currentPlatform),i}convertString(e){return typeof e!="string"?e:(this.webPushEvents.includes(e)?e.replace(/[^a-zA-Z0-9/_]/g,"-"):e.toLowerCase().replace(/[^a-z0-9/_]/g,"-")).replace(/\s{2,}/g," ").replace(/-{2,}/g,"-")}cleanup(){super.cleanup(),["onap","lqonap"].forEach(n=>Ze(n))}getParams(e,n=!1){const r={},i=S("hydra",e.actionType,e.value,n);if(i){const s=Ue("hydra",this.getDefaultParams(e)),a=this.getTrackParams(e,s);for(const[c,u]of Object.entries(a))Array.isArray(u)?r[c]=JSON.stringify(u):r[c]=u;return i.key&&(r[i.key]=i.value),e.actionType==="trackPage"&&(o.firstTrackedPageEvent=e.value),m()?.triggeredEvents?.includes(e.value)&&(r.rT=1),this.applyPlatform(r)}G.debug("Unknown event",e.actionType,e.value,e.props)}getDefaultParams(e){return e.actionType==="trackPage"&&(this.lastTrackedPageName=et()),Fn(e,this.lastTrackedPageName)}getCustomParams(e){const n={};for(const[r,i]of Object.entries(e.props)){const s=S("hydra",r,i);!s?.key||m().ignoreParams?.includes(s.key)||(n[s.key]=encodeURIComponent(s.value))}return n}}const On=d("registerTrackers");function ls(){const t=_(),e=t?.plugins??[],n=t?.custom?.[l().siteUrl];return n?.plugins&&e.push(...n.plugins),e.includes(N.laquesis)}function ds(){const t=[];return l().isNative||(t.push(new ss),t.push(new cs),t.push(new os),t.push(new es),t.push(new is)),t}async function gs(){const t=ds(),e=new us,n=()=>Promise.resolve();if(await e.setupListeners(),await e.init(),ls()){const r=new Ji,i=new Ui;await r.setupListeners(),await i.setupListeners(),await i.init()}for(const r of t)try{On.debug("Processing",r.trackerName),await r.setupListeners()}catch{}return On.debug("Trackers initialized"),n}const ne=d("startup");async function fs(){if(ne.debug("Starting Ninja on",'""@"517f2a47"','""'),l().environment!=="test"){if(!navigator.cookieEnabled){ne.debug("Cookies are disabled in the browser. Ninja will not start.");return}if(document.cookie="test=1; path=/; domain="+l().cookieDomain,await new Promise(e=>setTimeout(e,100)),document.cookie.indexOf("test=1")===-1){ne.debug("Cookies are not saved correctly. Ninja will not start.");return}document.cookie="test=; expires=Thu, 01 Jan 1970 00:00:01 GMT; path=/; domain="+l().cookieDomain}const t=await rr();await or(),ne.debug("Loaded region config and cookie storage"),_()?.custom?.[l().siteUrl]?(ne.debug("siteUrl found in region config"),pr(),P.init(),X.enqueue({fn:()=>gs(),priority:pe.HIGHEST,taskId:"registerTrackers"}),t&&X.enqueue({fn:async()=>{const e=Object.assign({},{trackEvent:[Kn.FETCHING_MATRIX]});P.push(e)},priority:pe.HIGHEST,taskId:"trackFetchingMatrix"}),X.enqueue({fn:()=>P.processDataLayer(),priority:pe.HIGHEST,taskId:"dataLayer.processDataLayer"})):ne.error("No site configuration found for the current site",l().siteUrl)}function ps(t,e={}){if(t){const n=Object.assign({},e,{trackEvent:Array.isArray(t)?t:[t]});P.push(n)}}function hs(t,e={}){const n=Object.assign({},e,{trackPage:t});P.push(n)}function ms(t,e={}){const n=Object.assign({},e,{trackLinkEvent:t});P.push(n)}function vs(t,e={}){const n=Object.assign({},e,{trackPerformanceEvent:t});P.push(n)}return queueMicrotask(()=>{fs()}),{getInfo:Hr,trackEvent:ps,trackPage:hs,trackLinkEvent:ms,trackPerformanceEvent:vs}}));
//# sourceMappingURL=ninja-motors.js.map
